name: Discord PR Notification

on:
  pull_request:
    types: [closed]

jobs:
  notify-discord:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest

    steps:
      - name: Send Discord Notification
        run: |
          echo "Sending Discord notification for PR #${{ github.event.pull_request.number }}"

          # Simple approach - just send basic info without complex description
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{
                 "embeds": [
                   {
                     "title": "PR #${{ github.event.pull_request.number }}: ${{ github.event.pull_request.title }}",
                     "color": 5763719,
                     "url": "${{ github.event.pull_request.html_url }}",
                     "footer": {
                       "text": "Merged to main"
                     },
                     "timestamp": "${{ github.event.pull_request.merged_at }}"
                   }
                 ]
               }' \
               https://discord.com/api/webhooks/1424456997004116006/ns9ihf3qORIAVpFIVvfKe6PL9qJn4oBqVq9DB4Ov6U58MbMxz_DMJDCrXbZYLmeV5BiV

          echo "Discord notification sent successfully"
